<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:pe="http://primefaces.org/ui/extensions">

    <h:head>
        <!-- ToDo: title muss noch dynamsich werden -->
        <title>Home</title>
        <style>
            .ui-menubar {
                position: fixed;
                width: 100%;
                justify-content: center;
                display: flex;
            }
            .login-container {
                max-width: 400px;
                margin: 100px auto;
                padding: 20px;
                border: 1px solid #ddd;
                border-radius: 10px;
            }
            .login-image {
                max-width: 400px;
                margin: 100px auto;
                padding: 20px;
            }
        </style>
    </h:head>
    <!-- Workaround um die Hintergrundfarbe für den kompletten Body zu ändern -->
    <!-- Orientiert sich an der Backgroundcolor der verwendeten Themes -->
    <h:body style="margin: 0; background-color: #{themeSwitcherBean.backgroundColor};">
        <f:view locale="#{localeBean.locale}">
            <f:loadBundle basename="messages" var="msg" />
            <p:growl id="growl" showDetail="true" />
            <h:form id="mainForm">
                <p:menubar style="display: flex; justify-content: center; top: 0; left: 0; z-index: 999;">
                    <p:menuitem icon="pi pi-home" style="margin-left: 10px;" url="/cleverquiz/index.xhtml" />
                    <p:menuitem value="#{msg['menu_news.text']}" url="/cleverquiz/pages/create_news.xhtml" />
                    <p:menuitem value="#{msg['menu_question.text']}" url="/cleverquiz/pages/create_question.xhtml" />
                    <p:menuitem value="#{msg['menu_quiz.text']}" onclick="PF('startGameDialog').show();" />
                    <p:menuitem value="#{msg['menu_category.text']}" onclick="PF('categoryDialog').show();" />
                    <p:menuitem value="#{msg['menu_friendslist.text']}" url="/cleverquiz/pages/friends.xhtml" />
                    <p:submenu label="User" icon="pi pi-fw pi-user" style="margin-right: 10px;">
                        <p:menuitem value="#{msg['menu_username.text']}" />
                        <p:menuitem value="#{msg['menu_profilesettings.text']}" url="/cleverquiz/pages/profile_settings.xhtml" />
                        <p:menuitem value="#{localeBean.language == 'en' ? 'Switch to English' : 'Wechsel zu Deutsch'}" action="#{localeBean.toggleLanguage}" immediate="true" onclick="location.reload();" />
                        <p:menuitem>
                            <h:outputLabel for="toggleSwitch" value="Darkmode:" />
                            <p:toggleSwitch id="toggleSwitch" value="#{themeSwitcherBean.darkTheme}" style="float: right;">
                                <p:ajax listener="#{themeSwitcherBean.setDarkTheme}" update="@none" oncomplete="location.reload();" />
                            </p:toggleSwitch>
                        </p:menuitem>
                        <p:menuitem value="Logout" url="/cleverquiz/pages/logout.xhtml" />
                    </p:submenu>
                </p:menubar>
            </h:form>
            <div class="layout-content" style="padding-top: 70px;">
                <ui:insert name="content" />
            </div>
            <h:form id="footerForm">
                <p:menubar style="bottom: 0; left: 0; right: 0; padding: 10px;">
                    <p:menuitem value="#{msg['menu_imprint.text']}" url="/cleverquiz/pages/imprint.xhtml" />
                    <p:menuitem value="Support" url="mailto:support@cleverquiz.de?subject=Supportanfrage" />
                    <p:menuitem value="#{msg['menu_privacy.text']}" url="/cleverquiz/pages/privacy.xhtml"/>
                </p:menubar>
            </h:form>
            <!-- Dialog for creating a new category -->
            <p:dialog header="Neue Kategorie anlegen" widgetVar="categoryDialog" modal="true" closable="true" resizable="false">
                <h:form id="categoryForm">
                    <p:panelGrid columns="2" columnClasses="label,value" styleClass="no-border" style="margin-bottom:10px;">
                        <h:outputLabel for="categoryName" value="Kategorie:" />
                        <h:inputText id="categoryName" value="#{categoryBean.categoryName}" />
                    </p:panelGrid>
                    <p:commandButton value="Save" action="#{categoryBean.saveCategory}" update=":growl, categoryForm" />
                </h:form>
            </p:dialog>
            <!-- Dialog for starting a new game -->
            <p:dialog header="Spiel starten" widgetVar="startGameDialog" modal="true" closable="true" resizable="false">
            <h:form id="startGameForm">
                <p:panelGrid columns="2" styleClass="ui-panelgrid-blank">
                    <h:outputLabel for="categorySelect" value="Kategorie:" />
                    <p:selectOneMenu id="categorySelect" value="#{gameBean.selectedCategory}">
                        <f:selectItems value="#{gameBean.categories}" var="category" itemLabel="#{category}" itemValue="#{category}" />
                    </p:selectOneMenu>
                    
                    <h:outputLabel for="questionCountSelect" value="Anzahl der Fragen:" />
                    <p:selectOneMenu id="questionCountSelect" value="#{gameBean.questionCount}">
                        <f:selectItem itemLabel="10" itemValue="10" />
                        <f:selectItem itemLabel="15" itemValue="15" />
                        <f:selectItem itemLabel="20" itemValue="20" />
                    </p:selectOneMenu>
                </p:panelGrid>
                
                <p:commandButton value="Start" action="#{gameBean.startGame}" update="startGameForm" oncomplete="PF('startGameDialog').hide(); window.location.href='/cleverquiz/pages/quiz.xhtml';" style="margin-top: 10px;" />
            </h:form>
        </p:dialog>
        </f:view>
    </h:body>
</html>